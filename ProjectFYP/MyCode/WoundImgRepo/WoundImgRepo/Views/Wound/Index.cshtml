@model List<WoundRecord>
@{
    Layout = "_Wound";
}
@if (TempData["Msg"] != null)
{
    <div class="alert alert-@TempData["MsgType"]">
        @TempData["Msg"]
    </div>
}

@section MoreScripts {
    <link href="~/lib/datatables/css/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="~/lib/datatables/js/jquery.dataTables.min.js"></script>

    <script>
        function ConfirmDelete() {
            if (confirm("Are you sure you want to delete? This will remove all records with the annotation as well.") == false)
            {
                event.preventDefault();
                event.stopPropagation();
                return false;
            }
        }

        $(document).ready(function () {
            $('#jsWoundsTable').DataTable({
                ordering: true,
                paging: true,
                searching: true,
                info: true,
                lengthChange: true,
                pageLength: 5
            });
        });
    </script>
}

<form asp-controller="Wound"
      asp-action="Indexpost"
      >
    <div class="col-sm-5">
        <!--Doing search-->
        <h4>Specified Search :</h4>
        <div class="form-group row">
            <label class="col-sm-2 font-weight-bold">Section: </label>
            <div class="col-sm-3">
                <select id="searchedsection" name="searchedsection" for="searchedsection">
                    <!--Viewbags are to be put inplace so as a user i don't have to keep reselecting my options if i made an error-->
                    @if (ViewBag.selection == "w.wound_id")
                    {
                        <option value="w.wound_id" selected>Wound Id</option>
                    }
                    else
                    {
                        <option value="w.wound_id">Wound Id</option>

                    }
                    @if (ViewBag.selection == "w.name")
                    {
                        <option value="w.name" selected>Wound Name</option>
                    }
                    else
                    {
                        <option value="w.name">Wound Name</option>
                    }
                    @if (ViewBag.selection == "w.wound_stage")
                    {
                        <option value="w.wound_stage" selected> Wound Stage </option>
                    }
                    else
                    {
                        <option value="w.wound_stage"> Wound Stage </option>
                    }
                    @if (ViewBag.selection == "w.remarks")
                    {
                        <option value="w.remarks" selected>Remarks</option>
                    }
                    else
                    {
                        <option value="w.remarks">Remarks</option>
                    }
                    @if (ViewBag.selection == "wc.name")
                    {
                        <option value="wc.name" selected>Wound Category</option>
                    }
                    else
                    {
                        <option value="wc.name">Wound Category</option>
                    }
                    @if (ViewBag.selection == "wl.name")
                    {
                        <option value="wl.name" selected>Wound Location</option>
                    }
                    else
                    {
                        <option value="wl.name">Wound Location</option>
                    }
                    @if (ViewBag.selection == "i.image_id")
                    {

                        <option value="i.image_id" selected>Image ID</option>
                    }
                    else
                    {
                        <option value="i.image_id">Image ID</option>
                    }
                    @if (ViewBag.selection == "t.name")
                    {
                        <option value="t.name" selected>Tissue</option>
                    }
                    else
                    {
                        <option value="t.name">Tissue</option>
                    }
                    @if (ViewBag.selection == "v.name")
                    {
                        <option value="v.name" selected>Version</option>
                    }
                    else
                    {
                        <option value="v.name">Version</option>
                    }
                    @if (ViewBag.selection == "u.username")
                    {
                        <option value="u.username" selected>username</option>
                    }
                    else
                    {
                    <option value="u.username">username</option>
                    }
                </select>
            </div>
            <div class="col-sm-8">
                <input id="searchedobj" name ="searchedobj" for="searchedobj" class="form-control" placeholder="Search in wound database                " autofocus="">
            </div>
            <div class="col-sm-1">
                <input type="submit" class="btn btn-outline-primary" value="Go" />
            </div>
        </div>
    </div>
    @if (TempData["Msg"] != null)
    {
        <div class="alert alert-@TempData["MsgType"]">
            @TempData["Msg"]
        </div>
    }
</form>


    <!--table set up-->
<style>
    img {
        width: 200px;
        height: 200px;
        object-fit: cover;
    }
</style>

<h2>Wounds</h2>
<table id="jsWoundsTable" class="table table-bordered table-condensed table-hover table-striped">
    <thead>
        <tr>
            <th scope="col" width="20%">Wound Id</th>
            <th scope="col" width="20%">Name</th>
            <th scope="col" width="20%">Wound Stage</th>
            <th scope="col" width="20%">Remarks</th>
            <th scope="col" width="20%">Wound Category</th>
            <th scope="col" width="20%">Wound Location</th>
            <th scope="col" width="20%">Original Wound Image</th>

            <th scope="col" width="20%">Tissue</th>
            <th scope="col" width="20%">Version</th>
            <th scope="col" width="20%">Details</th>
            @if (User.IsInRole("Admin") || User.IsInRole("Annotator"))
            {
            <th scope="col" width="20%">Username</th>
            
            <th scope="col" width="20%">Edit / Delete</th>
            }
        </tr>
    </thead>
    <tbody>
        @foreach (WoundRecord w in Model)
        {
        <tr scope="row">
            <td width="20%">@w.woundid</td>
            <td width="20%">@w.woundname</td>
            <td width="20%">@w.woundstage</td>
            <td width="20%">@w.woundremarks</td>
            <td width="20%">@w.woundcategoryname</td>
            <td width="20%">@w.woundlocationname</td>
            <td width="20%"><img src="~/photos/@w.imagefile"></td>

            <td width="20%">@w.tissuename</td>
            <td width="20%">@w.versionname</td>
            <td width="20%"><a asp-controller="Wound" asp-action="Details" asp-route-id="@w.woundid">Details</a></td>
            @if (User.IsInRole("Admin") || User.IsInRole("Annotator"))
            {
                <td width="20%">@w.username</td>


                <td width="20%">
                    <a asp-controller="Wound" asp-action="Update" asp-route-id="@w.woundid">Edit</a> |
                    <a asp-controller="Wound" asp-action="Delete" asp-route-id="@w.woundid"
                       onclick="return confirm('Delete Wound [@w.woundname] ?')">Delete</a>
                </td>
            }
        </tr>
        }
    </tbody>
</table>



